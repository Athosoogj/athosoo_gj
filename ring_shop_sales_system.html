<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아뜰리에호수 광주 매출입력 시스템</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Malgun Gothic', sans-serif;
            font-size: 16px; /* Increased font size by 2 points */
        }
        body {
            margin: 20px;
            padding: 0;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 24px; /* Increased font size by 2 points */
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"], select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px; /* Increased font size by 2 points */
        }
        .narrow-input {
            width: 120px !important;
            display: inline-block;
        }
        .payment-input {
            width: 120px !important;
            display: inline-block;
            margin-left: 10px;
        }
        .btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px; /* Increased font size by 2 points */
            margin-top: 10px;
        }
        .btn:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .customer-type {
            margin-right: 15px;
        }
        .section-title {
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 18px; /* Increased font size by 2 points */
        }
        .price-display {
            margin-top: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .price-text {
            font-weight: bold;
            font-size: 16px; /* Increased font size by 2 points */
        }
        .checkbox-column {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>아뜰리에호수 광주 매출입력 시스템</h1>

        <div class="form-group">
            <label for="customerName">예약자 이름</label>
            <input type="text" id="customerName" placeholder="예약자 이름을 입력하세요">
        </div>

        <div class="form-group">
            <label for="partySize">일행 수</label>
            <select id="partySize" onchange="generateTable()">
                <option value="1">1명</option>
                <option value="2">2명</option>
                <option value="3">3명</option>
                <option value="4">4명</option>
                <option value="5">5명</option>
                <option value="6">6명</option>
            </select>
        </div>

        <div class="section-title">고객 정보</div>
        <div id="customerTable"></div>

        <div class="section-title">제품 가격</div>
        <div class="price-display">
            <p class="price-text" id="priceCalculation">공급가 0원 + 부가세 0원 = 합계 0원</p>
        </div>

        <div class="section-title">결제 정보</div>
        <div class="form-group">
            <input type="checkbox" id="cashPayment" onchange="togglePaymentInput('cash')"> 현금
            <input type="text" id="cashAmount" class="payment-input" placeholder="천원" disabled>
            <span>천원</span>
        </div>

        <div class="form-group">
            <input type="checkbox" id="transferPayment" onchange="togglePaymentInput('transfer')"> 계좌이체
            <input type="text" id="transferAmount" class="payment-input" placeholder="천원" disabled>
            <span>천원</span>
        </div>

        <div class="form-group">
            <input type="checkbox" id="cardPayment" onchange="togglePaymentInput('card')"> 카드
            <input type="text" id="cardAmount" class="payment-input" placeholder="천원" disabled>
            <span>천원</span>
        </div>

        <div class="section-title">손님 형태</div>
        <div class="form-group">
            <input type="radio" name="customerType" id="normalCustomer" value="일반" checked> 
            <label for="normalCustomer" class="customer-type" style="display: inline;">일반</label>

            <input type="radio" name="customerType" id="experienceCustomer" value="체험"> 
            <label for="experienceCustomer" class="customer-type" style="display: inline;">체험</label>

            <input type="radio" name="customerType" id="otherCustomer" value="기타"> 
            <label for="otherCustomer" class="customer-type" style="display: inline;">기타</label>
        </div>

        <div class="form-group">
            <label for="notes">비고</label>
            <input type="text" id="notes" placeholder="추가 정보를 입력하세요">
        </div>

        <button class="btn" onclick="submitSales()">매출 입력</button>
    </div>

    <script>
        // 반지 제품 정보 (가격은 천원 단위로 표시)
        const ringProducts = [
            { name: "베이직", price_male: 80, price_female: 70 },
            { name: "플랫", price_male: 90, price_female: 90 },
            { name: "클래식", price_male: 90, price_female: 80 },
            { name: "젬스톤", price_male: 90, price_female: 100 },
            { name: "엥게이지", price_male: 120, price_female: 120 },
            { name: "파시넷", price_male: 130, price_female: 130 },
            { name: "쥬빌레", price_male: 130, price_female: 120 },
            { name: "루미에", price_male: 120, price_female: 110 },
            { name: "프로미스", price_male: 110, price_female: 100 },
            { name: "스텔라", price_male: 120, price_female: 130 },
            { name: "써밋", price_male: 140, price_female: 130 },
            { name: "키스톤", price_male: 130, price_female: 120 },
            { name: "포커스", price_male: 110, price_female: 120 },
            { name: "오르빗", price_male: 120, price_female: 110 },
            { name: "젬브릿지", price_male: 130, price_female: 140 },
            { name: "웨이브", price_male: 120, price_female: 130 },
            { name: "러브넛", price_male: 140, price_female: 130 },
            { name: "로미오와줄리엣", price_male: 150, price_female: 140 },
            { name: "새턴", price_male: 140, price_female: 150 }
        ];

        // 페이지 로드 시 고객 테이블 생성
        window.onload = function() {
            generateTable();
        };

        // 고객 테이블 생성 함수
        function generateTable() {
            const partySize = parseInt(document.getElementById('partySize').value);
            const tableContainer = document.getElementById('customerTable');

            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>제품명</th>
                            <th>디자인 성별</th>
                            <th>실측 사이즈</th>
                            <th>사용 재고 사이즈</th>
                            <th>도금 여부</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            for (let i = 0; i < partySize; i++) {
                tableHTML += `
                    <tr>
                        <td>
                            <select id="product-${i}" class="product-select" onchange="calculatePrice()">
                                ${ringProducts.map(product => 
                                    `<option value="${product.name}">${product.name} (남: ${product.price_male}천원, 여: ${product.price_female}천원)</option>`
                                ).join('')}
                            </select>
                        </td>
                        <td>
                            <select id="gender-${i}" class="gender-select" onchange="calculatePrice()">
                                <option value="M">M</option>
                                <option value="F">F</option>
                            </select>
                        </td>
                        <td>
                            <input type="text" id="size-${i}" class="size-input">
                        </td>
                        <td>
                            <select id="stock-size-${i}" class="stock-size-select">
                                <option value="4">4</option>
                                <option value="7">7</option>
                                <option value="10">10</option>
                                <option value="13">13</option>
                                <option value="16">16</option>
                                <option value="20">20</option>
                            </select>
                        </td>
                        <td class="checkbox-column">
                            <input type="checkbox" id="plating-${i}" class="plating-checkbox" onchange="calculatePrice()">
                        </td>
                    </tr>
                `;
            }

            tableHTML += `
                    </tbody>
                </table>
            `;

            tableContainer.innerHTML = tableHTML;

            // 테이블 생성 후 가격 계산
            calculatePrice();
        }

        // 가격 계산 함수
        function calculatePrice() {
            const partySize = parseInt(document.getElementById('partySize').value);
            let totalPrice = 0;

            for (let i = 0; i < partySize; i++) {
                const productName = document.getElementById(`product-${i}`).value;
                const gender = document.getElementById(`gender-${i}`).value;
                const isPlated = document.getElementById(`plating-${i}`).checked;

                // 제품 찾기
                const product = ringProducts.find(p => p.name === productName);

                if (product) {
                    // 성별에 따른 가격 선택
                    const basePrice = gender === 'M' ? product.price_male : product.price_female;

                    // 도금 여부에 따른 추가 가격 (20천원)
                    const platingPrice = isPlated ? 20 : 0;

                    // 해당 고객의 총 가격 (천원 단위)
                    const customerPrice = basePrice + platingPrice;

                    // 전체 가격에 추가
                    totalPrice += customerPrice;
                }
            }

            // 부가세 계산 (10%)
            const supplyPrice = totalPrice;
            const vat = Math.round(supplyPrice * 0.1);
            const finalPrice = supplyPrice + vat;

            // 가격 표시 업데이트 (천원 단위로 표시)
            document.getElementById('priceCalculation').innerText = 
                `공급가 ${supplyPrice}천원 + 부가세 ${vat}천원 = 합계 ${finalPrice}천원`;
        }

        // 결제 입력창 토글 함수
        function togglePaymentInput(type) {
            const isChecked = document.getElementById(`${type}Payment`).checked;
            document.getElementById(`${type}Amount`).disabled = !isChecked;

            if (!isChecked) {
                document.getElementById(`${type}Amount`).value = '';
            }
        }

        // 매출 입력 함수
        function submitSales() {
            // 가격 계산에서 최종 가격 가져오기
            const priceText = document.getElementById('priceCalculation').innerText;
            const finalPriceMatch = priceText.match(/합계 (\d+)천원/);
            const calculatedPrice = finalPriceMatch ? parseInt(finalPriceMatch[1]) : 0;

            // 결제 금액 합계 계산
            let totalPayment = 0;

            // 현금 결제
            if (document.getElementById('cashPayment').checked) {
                const cashAmount = document.getElementById('cashAmount').value.trim();
                if (cashAmount) {
                    totalPayment += parseInt(cashAmount);
                }
            }

            // 계좌이체 결제
            if (document.getElementById('transferPayment').checked) {
                const transferAmount = document.getElementById('transferAmount').value.trim();
                if (transferAmount) {
                    totalPayment += parseInt(transferAmount);
                }
            }

            // 카드 결제
            if (document.getElementById('cardPayment').checked) {
                const cardAmount = document.getElementById('cardAmount').value.trim();
                if (cardAmount) {
                    totalPayment += parseInt(cardAmount);
                }
            }

            // 가격 일치 여부 확인
            if (calculatedPrice !== totalPayment) {
                // 불일치할 경우 확인 팝업
                const confirmMessage = "금액의 합계가 일치하지 않습니다. 입력하시겠습니까?";
                if (confirm(confirmMessage)) {
                    // '예' 선택 시 데이터 저장 및 전송
                    saveData();
                } else {
                    // '아니오' 선택 시 함수 종료
                    return;
                }
            } else {
                // 가격이 일치하면 바로 데이터 저장 및 전송
                saveData();
            }
        }

        // 데이터 저장 및 전송 함수
        function saveData() {
            // 여기서 실제로 데이터를 서버에 전송하거나 localStorage에 저장
            // 실제 구현에서는 이 부분에 AJAX 요청이나 localStorage 저장 코드 추가

            // 예시: localStorage에 저장
            const salesData = {
                timestamp: new Date().toISOString(),
                customerName: document.getElementById('customerName').value,
                partySize: document.getElementById('partySize').value,
                products: [],
                cashPayment: document.getElementById('cashPayment').checked ? document.getElementById('cashAmount').value : 0,
                transferPayment: document.getElementById('transferPayment').checked ? document.getElementById('transferAmount').value : 0,
                cardPayment: document.getElementById('cardPayment').checked ? document.getElementById('cardAmount').value : 0,
                customerType: document.querySelector('input[name="customerType"]:checked').value,
                notes: document.getElementById('notes').value
            };

            // 고객별 제품 정보 수집
            const partySize = parseInt(document.getElementById('partySize').value);
            for (let i = 0; i < partySize; i++) {
                salesData.products.push({
                    productName: document.getElementById(`product-${i}`).value,
                    gender: document.getElementById(`gender-${i}`).value,
                    size: document.getElementById(`size-${i}`).value,
                    stockSize: document.getElementById(`stock-size-${i}`).value,
                    plating: document.getElementById(`plating-${i}`).checked
                });
            }

            // localStorage에 저장 (이전 데이터가 있으면 추가)
            let allSales = JSON.parse(localStorage.getItem('ringSales') || '[]');
            allSales.push(salesData);
            localStorage.setItem('ringSales', JSON.stringify(allSales));

            // 전송 완료 알림
            alert('전송되었습니다');

            // 폼 초기화
            resetForm();
        }

        // 폼 초기화 함수
        function resetForm() {
            document.getElementById('customerName').value = '';
            document.getElementById('partySize').value = '1';
            document.getElementById('cashPayment').checked = false;
            document.getElementById('cashAmount').value = '';
            document.getElementById('cashAmount').disabled = true;
            document.getElementById('transferPayment').checked = false;
            document.getElementById('transferAmount').value = '';
            document.getElementById('transferAmount').disabled = true;
            document.getElementById('cardPayment').checked = false;
            document.getElementById('cardAmount').value = '';
            document.getElementById('cardAmount').disabled = true;
            document.getElementById('normalCustomer').checked = true;
            document.getElementById('notes').value = '';

            // 테이블 재생성
            generateTable();
        }
    </script>
</body>
</html>
